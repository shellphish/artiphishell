# syzlang_bridge

Library for interacting with syzlang from python

# Usage

Apply the patch in the patches directory to syzkaller (patch is based on syzkaller commit e812177).

Run `make descriptions` to generate a JSON representation of the syzkaller grammar in `syzkaller/sys/json/linux/amd64.json`.

Load the grammar using `Syzlang.from_json(path)` and make modifications to the grammar, when done the grammar can be written out using the `.generate_go(path)` function.

The go file matches the format of the go files generated by syz-sysgen, located in `sykaller/sys/linux/gen/*.go`.

Replace the go file of the target arch with the go file generated by `generate_go` and then run `make` to finish building syzkaller.


## Loading from JSON
```python
from syzlang_bridge import *

syzlang = Syzlang.from_json("./amd64.json")
```

## Accessing grammar

```python
print(syzlang.syscalls[0])
print(syzlang.syscalls['read'])

for syscall in syzlang.syscalls: print(syscall)

for resource in syzlang.resources: print(resource)

for typ in syzlang.types: print(typ)
```

## Modifying grammar

```python
myconst = ConstType('myconst', 8, 8, False, False, BinaryFormat.Native, 0, 0, 0, 0, 0x1337, False)
syzlang.types.add(myconst)

myfield = Field('myfield', myconst, False, Direction.DirIn)

syzlang.syscalls.add(Syscall(1, "mysyscall", "mysyscall", None, [myfield]))

```

## Saving grammar
```python
syzlang.generate_go("./amd64.go")
```

## Generating inputs
```sh
$ ./bin/syz-mutate -enable mysyscall,getpid
mysyscall(0x1337)
mysyscall(0x1337)
getpid()
getpid()
...
```

# TODO

- Allow grammar to be written out to rust for syzlangrs
- Fields can have a "Condition" field containing an expression
