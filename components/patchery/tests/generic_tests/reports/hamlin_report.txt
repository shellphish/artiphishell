There is a buffer overflow in this function.