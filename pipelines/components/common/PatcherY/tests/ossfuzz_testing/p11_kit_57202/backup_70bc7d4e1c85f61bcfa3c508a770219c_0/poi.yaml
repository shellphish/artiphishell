additional_information:
  asan_report_data:
    cp_harness_binary_path: out/rpc_fuzzer
    cp_harness_id: id_1
    cp_harness_name: rpc_fuzzer
    cp_harness_source_path: src/p11-kit/fuzz/fuzz.h
    crash_action:
      access: read
      size: 8
    crash_report_id: 4f1ae076d3fe19fa76d5576e3ac0d2fa
    crash_type: global-buffer-overflow
    fuzzer: aflplusplus
    harness_info_id: a7e2de27a55f4a4bd8c979419da18640
    sanitizer: 'AddressSanitizer: global-buffer-overflow'
    stack_traces:
      main:
      - depth: 0
        func_name: base_C_MessageSignFinal
        line: 3413
        signature: base_C_MessageSignFinal
        src_file: p11-kit/p11-kit/virtual.c
        src_loc: p11-kit/p11-kit/virtual.c:3413
        type: source
      - depth: 1
        func_name: rpc_C_MessageSignFinal
        line: 2156
        signature: rpc_C_MessageSignFinal
        src_file: p11-kit/p11-kit/rpc-server.c
        src_loc: p11-kit/p11-kit/rpc-server.c:2156
        type: source
      - depth: 2
        func_name: p11_rpc_server_handle
        line: 2362
        signature: p11_rpc_server_handle
        src_file: p11-kit/p11-kit/rpc-server.c
        src_loc: p11-kit/p11-kit/rpc-server.c:2362
        type: source
      - depth: 3
        func_name: LLVMFuzzerTestOneInput
        line: 49
        signature: LLVMFuzzerTestOneInput
        src_file: p11-kit/fuzz/rpc_fuzzer.c
        src_loc: p11-kit/fuzz/rpc_fuzzer.c:49
        type: source
      - depth: 4
        func_name: fuzzer::Fuzzer::ExecuteCallback
        line: 614
        signature: fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned
          long)
        src_file: llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp
        src_loc: llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614
        type: source
      - depth: 5
        func_name: fuzzer::RunOneTest
        line: 327
        signature: fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long)
        src_file: llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp
        src_loc: llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327
        type: source
      - depth: 6
        func_name: fuzzer::FuzzerDriver
        line: 862
        signature: fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*,
          unsigned long))
        src_file: llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp
        src_loc: llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862
        type: source
      - depth: 7
        func_name: main
        line: 20
        signature: main
        src_file: llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp
        src_loc: llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20
        type: source
      - binary: ../../lib/x86_64-linux-gnu/libc.so.6
        build_id: 0702430aef5fa3dda43986563e9ffcc47efbd75e
        depth: 8
        func_name: __libc_start_main
        offset: 147586
        signature: __libc_start_main
        type: binary
      - binary: ../(/out/rpc_fuzzer+0x1ba7fd)
        depth: 9
        func_name: _start
        signature: _start
        type: maybe_asan_interceptor
    target_id: 1
    triggered_sanitizer_cp_ids:
    - id_1
  sanitizer: 'AddressSanitizer: global-buffer-overflow'
crash_id: 4f1ae076d3fe19fa76d5576e3ac0d2fa
crash_reason: global-buffer-overflow
detection_strategy: fuzzing
harness_id: id_1
pois:
- reason: global-buffer-overflow
  source_location:
    function_name: base_C_MessageSignFinal
    function_signature: int base_C_MessageSignFinal(int *, int)
    key_index: p11-kit/p11-kit/virtual.c:3407:1::int base_C_MessageSignFinal(int *,
      int)
    line_number: 3413
    line_text: "\treturn funcs->C_MessageSignFinal (session);"
    relative_file_path: p11-kit/p11-kit/virtual.c
    symbol_offset: 0
    symbol_size: 0
- reason: global-buffer-overflow
  source_location:
    function_name: rpc_C_MessageSignFinal
    function_signature: int rpc_C_MessageSignFinal(int *, p11_rpc_message *)
    key_index: p11-kit/p11-kit/rpc-server.c:2148:1::int rpc_C_MessageSignFinal(int
      *, p11_rpc_message *)
    line_number: 2156
    line_text: "\tPROCESS_CALL ((self, session));"
    relative_file_path: p11-kit/p11-kit/rpc-server.c
    symbol_offset: 0
    symbol_size: 0
- reason: global-buffer-overflow
  source_location:
    function_name: p11_rpc_server_handle
    function_signature: int p11_rpc_server_handle(int *, int *, int *)
    key_index: p11-kit/p11-kit/rpc-server.c:2247:1::int p11_rpc_server_handle(int
      *, int *, int *)
    line_number: 2362
    line_text: "\tCASE_CALL (C_MessageSignFinal)"
    relative_file_path: p11-kit/p11-kit/rpc-server.c
    symbol_offset: 0
    symbol_size: 0
- reason: global-buffer-overflow
  source_location:
    function_name: LLVMFuzzerTestOneInput
    function_signature: int LLVMFuzzerTestOneInput(const int *, int)
    key_index: p11-kit/fuzz/rpc_fuzzer.c:34:1::int LLVMFuzzerTestOneInput(const int
      *, int)
    line_number: 49
    line_text: '    p11_rpc_server_handle (&base.funcs, &buffer, &buffer);'
    relative_file_path: p11-kit/fuzz/rpc_fuzzer.c
    symbol_offset: 0
    symbol_size: 0
scanner: asan
stack_traces:
- call_locations:
  - function: int base_C_MessageSignFinal(int *, int)
    function_name: base_C_MessageSignFinal
    key_index: p11-kit/p11-kit/virtual.c:3407:1::int base_C_MessageSignFinal(int *,
      int)
    line_number: 3413
    line_text: "\treturn funcs->C_MessageSignFinal (session);"
    relative_file_path: p11-kit/p11-kit/virtual.c
    symbol_offset: 0
    symbol_size: 0
    trace_line: base_C_MessageSignFinal
  - function: int rpc_C_MessageSignFinal(int *, p11_rpc_message *)
    function_name: rpc_C_MessageSignFinal
    key_index: p11-kit/p11-kit/rpc-server.c:2148:1::int rpc_C_MessageSignFinal(int
      *, p11_rpc_message *)
    line_number: 2156
    line_text: "\tPROCESS_CALL ((self, session));"
    relative_file_path: p11-kit/p11-kit/rpc-server.c
    symbol_offset: 0
    symbol_size: 0
    trace_line: rpc_C_MessageSignFinal
  - function: int p11_rpc_server_handle(int *, int *, int *)
    function_name: p11_rpc_server_handle
    key_index: p11-kit/p11-kit/rpc-server.c:2247:1::int p11_rpc_server_handle(int
      *, int *, int *)
    line_number: 2362
    line_text: "\tCASE_CALL (C_MessageSignFinal)"
    relative_file_path: p11-kit/p11-kit/rpc-server.c
    symbol_offset: 0
    symbol_size: 0
    trace_line: p11_rpc_server_handle
  - function: int LLVMFuzzerTestOneInput(const int *, int)
    function_name: LLVMFuzzerTestOneInput
    key_index: p11-kit/fuzz/rpc_fuzzer.c:34:1::int LLVMFuzzerTestOneInput(const int
      *, int)
    line_number: 49
    line_text: '    p11_rpc_server_handle (&base.funcs, &buffer, &buffer);'
    relative_file_path: p11-kit/fuzz/rpc_fuzzer.c
    symbol_offset: 0
    symbol_size: 0
    trace_line: LLVMFuzzerTestOneInput
  - function: fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long)
    function_name: fuzzer::Fuzzer::ExecuteCallback
    key_index: null
    line_number: 614
    line_text: null
    relative_file_path: llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp
    symbol_offset: 0
    symbol_size: 0
    trace_line: fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long)
  - function: fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long)
    function_name: fuzzer::RunOneTest
    key_index: null
    line_number: 327
    line_text: null
    relative_file_path: llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp
    symbol_offset: 0
    symbol_size: 0
    trace_line: fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long)
  - function: fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned
      long))
    function_name: fuzzer::FuzzerDriver
    key_index: null
    line_number: 862
    line_text: null
    relative_file_path: llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp
    symbol_offset: 0
    symbol_size: 0
    trace_line: fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*,
      unsigned long))
  - function: main
    function_name: main
    key_index: null
    line_number: 20
    line_text: null
    relative_file_path: llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp
    symbol_offset: 0
    symbol_size: 0
    trace_line: main
  - function: __libc_start_main
    function_name: __libc_start_main
    key_index: null
    line_number: 0
    line_text: null
    relative_file_path: ../../lib/x86_64-linux-gnu/libc.so.6
    symbol_offset: 147586
    symbol_size: 0
    trace_line: __libc_start_main
  reason: Not specified
target_id: '1'
