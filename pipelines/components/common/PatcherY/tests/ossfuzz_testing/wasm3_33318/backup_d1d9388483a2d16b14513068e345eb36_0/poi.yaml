additional_information:
  asan_report_data:
    cp_harness_binary_path: out/fuzzer
    cp_harness_id: id_1
    cp_harness_name: fuzzer
    cp_harness_source_path: src/wasm3/platforms/app_fuzz/fuzzer.c
    crash_action:
      access: write
      size: 8
    crash_report_id: b2e61bdf9777b4ad995826af7fe6f7b7
    crash_type: heap-buffer-overflow
    fuzzer: aflplusplus
    harness_info_id: cdfb1b2868dc76011bdede6a51e2782b
    sanitizer: 'AddressSanitizer: heap-buffer-overflow'
    stack_traces:
      allocate:
      - depth: 0
        func_name: calloc
        line: 77
        signature: calloc
        src_file: llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp
        src_loc: llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:77
        type: source
      - depth: 1
        func_name: m3_NewRuntime
        line: 180
        signature: m3_NewRuntime
        src_file: wasm3/source/m3_env.c
        src_loc: wasm3/source/m3_env.c:180
        type: source
      - depth: 2
        func_name: LLVMFuzzerTestOneInput
        line: 25
        signature: LLVMFuzzerTestOneInput
        src_file: wasm3/platforms/app_fuzz/fuzzer.c
        src_loc: wasm3/platforms/app_fuzz/fuzzer.c:25
        type: source
      - depth: 3
        func_name: fuzzer::Fuzzer::ExecuteCallback
        line: 614
        signature: fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned
          long)
        src_file: llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp
        src_loc: llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614
        type: source
      - depth: 4
        func_name: fuzzer::RunOneTest
        line: 327
        signature: fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long)
        src_file: llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp
        src_loc: llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327
        type: source
      - depth: 5
        func_name: fuzzer::FuzzerDriver
        line: 862
        signature: fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*,
          unsigned long))
        src_file: llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp
        src_loc: llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862
        type: source
      - depth: 6
        func_name: main
        line: 20
        signature: main
        src_file: llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp
        src_loc: llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20
        type: source
      - binary: ../../lib/x86_64-linux-gnu/libc.so.6
        build_id: 0702430aef5fa3dda43986563e9ffcc47efbd75e
        depth: 7
        func_name: __libc_start_main
        offset: 147586
        signature: __libc_start_main
        type: binary
      main:
      - depth: 0
        func_name: op_Const64
        line: 1175
        signature: op_Const64
        src_file: wasm3/source/m3_exec.h
        src_loc: wasm3/source/m3_exec.h:1175
        type: source
      - depth: 1
        func_name: Call
        line: 98
        signature: Call
        src_file: wasm3/source/m3_exec.h
        src_loc: wasm3/source/m3_exec.h:98
        type: source
      - depth: 2
        func_name: EvaluateExpression
        line: 291
        signature: EvaluateExpression
        src_file: wasm3/source/m3_env.c
        src_loc: wasm3/source/m3_env.c:291
        type: source
      - depth: 3
        func_name: InitDataSegments
        line: 449
        signature: InitDataSegments
        src_file: wasm3/source/m3_env.c
        src_loc: wasm3/source/m3_env.c:449
        type: source
      - depth: 4
        func_name: m3_LoadModule
        line: 552
        signature: m3_LoadModule
        src_file: wasm3/source/m3_env.c
        src_loc: wasm3/source/m3_env.c:552
        type: source
      - depth: 5
        func_name: LLVMFuzzerTestOneInput
        line: 30
        signature: LLVMFuzzerTestOneInput
        src_file: wasm3/platforms/app_fuzz/fuzzer.c
        src_loc: wasm3/platforms/app_fuzz/fuzzer.c:30
        type: source
      - depth: 6
        func_name: fuzzer::Fuzzer::ExecuteCallback
        line: 614
        signature: fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned
          long)
        src_file: llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp
        src_loc: llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614
        type: source
      - depth: 7
        func_name: fuzzer::RunOneTest
        line: 327
        signature: fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long)
        src_file: llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp
        src_loc: llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327
        type: source
      - depth: 8
        func_name: fuzzer::FuzzerDriver
        line: 862
        signature: fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*,
          unsigned long))
        src_file: llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp
        src_loc: llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862
        type: source
      - depth: 9
        func_name: main
        line: 20
        signature: main
        src_file: llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp
        src_loc: llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20
        type: source
      - binary: ../../lib/x86_64-linux-gnu/libc.so.6
        build_id: 0702430aef5fa3dda43986563e9ffcc47efbd75e
        depth: 10
        func_name: __libc_start_main
        offset: 147586
        signature: __libc_start_main
        type: binary
      - binary: ../(/out/fuzzer+0x556dd)
        depth: 11
        func_name: _start
        signature: _start
        type: maybe_asan_interceptor
    target_id: 1
    triggered_sanitizer_cp_ids:
    - id_1
  sanitizer: 'AddressSanitizer: heap-buffer-overflow'
crash_id: b2e61bdf9777b4ad995826af7fe6f7b7
crash_reason: heap-buffer-overflow
detection_strategy: fuzzing
harness_id: id_1
pois:
- reason: heap-buffer-overflow
  source_location:
    function_name: EvaluateExpression
    function_signature: M3Result EvaluateExpression(IM3Module, void *, u8, bytes_t
      *, cbytes_t)
    key_index: wasm3/source/m3_env.c:247:1::M3Result EvaluateExpression(IM3Module,
      void *, u8, bytes_t *, cbytes_t)
    line_number: 291
    line_text: '            m3ret_t r = Call (m3code, stack, NULL, d_m3OpDefaultArgs);'
    relative_file_path: wasm3/source/m3_env.c
    symbol_offset: 0
    symbol_size: 0
- reason: heap-buffer-overflow
  source_location:
    function_name: InitDataSegments
    function_signature: M3Result InitDataSegments(M3Memory *, IM3Module)
    key_index: wasm3/source/m3_env.c:439:1::M3Result InitDataSegments(M3Memory *,
      IM3Module)
    line_number: 449
    line_text: _       (EvaluateExpression (io_module, & segmentOffset, c_m3Type_i32,
      & start, segment->initExpr + segment->initExprSize));
    relative_file_path: wasm3/source/m3_env.c
    symbol_offset: 0
    symbol_size: 0
- reason: heap-buffer-overflow
  source_location:
    function_name: m3_LoadModule
    function_signature: M3Result m3_LoadModule(IM3Runtime, IM3Module)
    key_index: wasm3/source/m3_env.c:541:1::M3Result m3_LoadModule(IM3Runtime, IM3Module)
    line_number: 552
    line_text: _       (InitDataSegments (memory, io_module));
    relative_file_path: wasm3/source/m3_env.c
    symbol_offset: 0
    symbol_size: 0
scanner: asan
stack_traces:
- call_locations:
  - function: op_Const64
    function_name: op_Const64
    key_index: null
    line_number: 1175
    line_text: null
    relative_file_path: wasm3/source/m3_exec.h
    symbol_offset: 0
    symbol_size: 0
    trace_line: op_Const64
  - function: Call
    function_name: Call
    key_index: null
    line_number: 98
    line_text: null
    relative_file_path: wasm3/source/m3_exec.h
    symbol_offset: 0
    symbol_size: 0
    trace_line: Call
  - function: M3Result EvaluateExpression(IM3Module, void *, u8, bytes_t *, cbytes_t)
    function_name: EvaluateExpression
    key_index: wasm3/source/m3_env.c:247:1::M3Result EvaluateExpression(IM3Module,
      void *, u8, bytes_t *, cbytes_t)
    line_number: 291
    line_text: '            m3ret_t r = Call (m3code, stack, NULL, d_m3OpDefaultArgs);'
    relative_file_path: wasm3/source/m3_env.c
    symbol_offset: 0
    symbol_size: 0
    trace_line: EvaluateExpression
  - function: M3Result InitDataSegments(M3Memory *, IM3Module)
    function_name: InitDataSegments
    key_index: wasm3/source/m3_env.c:439:1::M3Result InitDataSegments(M3Memory *,
      IM3Module)
    line_number: 449
    line_text: _       (EvaluateExpression (io_module, & segmentOffset, c_m3Type_i32,
      & start, segment->initExpr + segment->initExprSize));
    relative_file_path: wasm3/source/m3_env.c
    symbol_offset: 0
    symbol_size: 0
    trace_line: InitDataSegments
  - function: M3Result m3_LoadModule(IM3Runtime, IM3Module)
    function_name: m3_LoadModule
    key_index: wasm3/source/m3_env.c:541:1::M3Result m3_LoadModule(IM3Runtime, IM3Module)
    line_number: 552
    line_text: _       (InitDataSegments (memory, io_module));
    relative_file_path: wasm3/source/m3_env.c
    symbol_offset: 0
    symbol_size: 0
    trace_line: m3_LoadModule
  - function: int LLVMFuzzerTestOneInput(const uint8_t *, size_t)
    function_name: LLVMFuzzerTestOneInput
    key_index: wasm3/platforms/app_fuzz/fuzzer.c:15:1::int LLVMFuzzerTestOneInput(const
      uint8_t *, size_t)
    line_number: 30
    line_text: '                result = m3_LoadModule (runtime, module);'
    relative_file_path: wasm3/platforms/app_fuzz/fuzzer.c
    symbol_offset: 0
    symbol_size: 0
    trace_line: LLVMFuzzerTestOneInput
  - function: fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long)
    function_name: fuzzer::Fuzzer::ExecuteCallback
    key_index: null
    line_number: 614
    line_text: null
    relative_file_path: llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp
    symbol_offset: 0
    symbol_size: 0
    trace_line: fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long)
  - function: fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long)
    function_name: fuzzer::RunOneTest
    key_index: null
    line_number: 327
    line_text: null
    relative_file_path: llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp
    symbol_offset: 0
    symbol_size: 0
    trace_line: fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long)
  - function: fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned
      long))
    function_name: fuzzer::FuzzerDriver
    key_index: null
    line_number: 862
    line_text: null
    relative_file_path: llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp
    symbol_offset: 0
    symbol_size: 0
    trace_line: fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*,
      unsigned long))
  - function: main
    function_name: main
    key_index: null
    line_number: 20
    line_text: null
    relative_file_path: llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp
    symbol_offset: 0
    symbol_size: 0
    trace_line: main
  - function: __libc_start_main
    function_name: __libc_start_main
    key_index: null
    line_number: 0
    line_text: null
    relative_file_path: ../../lib/x86_64-linux-gnu/libc.so.6
    symbol_offset: 147586
    symbol_size: 0
    trace_line: __libc_start_main
  reason: Not specified
target_id: '1'
